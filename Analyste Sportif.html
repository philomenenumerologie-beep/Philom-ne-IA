<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Philom√®ne IA ‚Äî Analyste Sportif</title>
  <style>
    :root{
      --bg-a:#06110a;
      --bg-b:#0b1b1e;
      --grad-1:#36d16d;
      --grad-2:#2aa3ff;
      --card:#0f1c1a;
      --text:#fff;
      --muted:#bfe8ff;
      --accent:#9af1c6;
      --btn-1:#36d16d;
      --btn-2:#2aa3ff;
      --user:#0f2a24;
      --bot:#0b1a19;
    }
    *{box-sizing:border-box}
    body{
      margin:0;color:var(--text);
      font-family: "Poppins",system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
      background:
        radial-gradient(1100px 760px at -5% -20%, rgba(54,209,109,.22), transparent 60%),
        radial-gradient(1100px 760px at 120% -10%, rgba(42,163,255,.22), transparent 60%),
        linear-gradient(160deg, var(--bg-a), var(--bg-b) 70%);
      min-height:100dvh; display:flex; align-items:center; justify-content:center; padding:32px;
    }
    .app{ width:min(920px, 100%); background:rgba(5,12,10,.55); border:1px solid rgba(42,163,255,.18);
      border-radius:20px; box-shadow:0 10px 40px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.04) }
    header{ padding:28px 26px 10px }
    h1{ margin:0; font-size:clamp(26px, 4.5vw, 36px); line-height:1.15; }
    .brand{display:flex; gap:14px; align-items:center}
    .logo{width:46px; height:46px; border-radius:12px; background:
      radial-gradient(70% 70% at 60% 35%, rgba(255,255,255,.9), rgba(255,255,255,.15) 60%),
      linear-gradient(135deg, var(--grad-1), var(--grad-2));
      box-shadow: 0 10px 25px rgba(42,163,255,.22), inset 0 0 30px rgba(255,255,255,.12)}
    .subtitle{color:var(--muted); margin-top:6px}

    .chat{ padding: 0 16px 16px; display:flex; flex-direction:column; gap:12px; max-height:60dvh; overflow:auto }
    .bubble{ border-radius:16px; padding:14px 16px; line-height:1.55; }
    .bot{ align-self:flex-start; background:var(--bot); border:1px solid rgba(42,163,255,.18)}
    .you{ align-self:flex-end; background:var(--user); border:1px solid rgba(42,163,255,.14)}
    .system{ color:#bff6dc }

    .composer{ display:flex; gap:10px; padding:16px; border-top:1px solid rgba(42,163,255,.18); background:rgba(0,0,0,.25); border-radius:0 0 20px 20px }
    textarea{
      flex:1; resize:none; min-height:52px; max-height:160px; padding:14px 14px 14px 16px;
      color:var(--text); background:rgba(255,255,255,.03); border:1px solid rgba(42,163,255,.2);
      border-radius:12px; outline:none; box-shadow: inset 0 1px 0 rgba(255,255,255,.05);
    }
    button{
      background:linear-gradient(135deg, var(--btn-1), var(--btn-2));
      color:#fff; border:0; padding:0 22px; border-radius:12px; font-weight:600; cursor:pointer;
      display:flex; align-items:center; gap:10px; min-height:52px; box-shadow:0 10px 22px rgba(54,209,109,.25)
    }
    button:disabled{ opacity:.6; cursor:not-allowed }
    .tips{ color:#bfe8ff; font-size:.85rem; padding:0 22px 18px }
    .fade{ animation:fade .35s ease }
    @keyframes fade{ from{opacity:.35; transform:translateY(4px)} to{opacity:1; transform:none} }
  </style>
</head>
<body>
  <main class="app">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Analyste Sportif</h1>
          <div class="subtitle">Stats ‚Ä¢ Tactiques ‚Ä¢ Pr√©paration ‚Ä¢ Progression</div>
        </div>
      </div>
    </header>

    <section id="chat" class="chat">
      <div class="bubble bot fade">
        <strong>Bienvenue üëã</strong><br />
        Je suis <strong class="system">Philom√®ne Analyste Sportif</strong>. Je t‚Äôaide √† comprendre tactiques,
        statistiques, pr√©paration mentale/physique, planification d‚Äôentra√Ænement et analyses de matchs.
        Sports co ou individuels, amateur ou comp√©titeur ‚Äî on construit des plans concrets. üèÉ‚Äç‚ôÄÔ∏è‚öΩüèÄ
      </div>
    </section>

    <form id="composer" class="composer">
      <textarea id="input" placeholder="Dis-moi ton sport, ton niveau, ton objectif‚Ä¶"></textarea>
      <button id="send" type="submit">Envoyer üü¢</button>
    </form>
    <div class="tips">Exemples : ¬´ Programme 3 s√©ances/sem‚Ä¶ ¬ª, ¬´ Analyse ce match‚Ä¶ ¬ª, ¬´ Plan nutrition simple‚Ä¶ ¬ª</div>
  </main>

  <script>
    const ENDPOINT_PATH = "/chat";

    const SYSTEM_PROMPT = `
Tu es Philom√®ne Analyste Sportif : pr√©cis, structur√©, motivant.
- Tu poses (si besoin) 3 questions cl√©s (objectif, niveau, contraintes).
- Tu fournis des plans d'entra√Ænement, des plages d'intensit√©, des rep√®res mesurables.
- Tu expliques les principes (surcompensation, RPE, p√©riodisation, r√©cup√©ration) simplement.
- Tu signales les limites : pas de diagnostic m√©dical.
- Tu termines par 3 indicateurs concrets de suivi.
R√©ponds en fran√ßais.`;

    const chat = document.getElementById('chat');
    const form = document.getElementById('composer');
    const input = document.getElementById('input');
    const sendBtn = document.getElementById('send');

    function addBubble(text, who="bot"){
      const div = document.createElement('div');
      div.className = `bubble ${who} fade`;
      div.innerHTML = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    async function ask(text){
      sendBtn.disabled = true;
      addBubble(text, "you");
      try{
        const r = await fetch(ENDPOINT_PATH, {
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body: JSON.stringify({ system: SYSTEM_PROMPT, message: text, agent:"sport"})
        });
        const data = await r.json();
        addBubble(data.reply || "D√©sol√©, je n‚Äôai pas pu r√©pondre cette fois.");
      }catch(e){
        addBubble("Oups, une erreur s‚Äôest produite. R√©essaie.");
      }finally{
        sendBtn.disabled = false;
      }
    }

    form.addEventListener('submit', e=>{
      e.preventDefault();
      const text = input.value.trim();
      if(!text) return;
      input.value = "";
      ask(text);
    });
  </script>
</body>
</html>
