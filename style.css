:root{
  --bg: #0b0b0f;
  --panel: #14141b;
  --border: rgba(255,255,255,.12);
  --muted: rgba(255,255,255,.6);
  --text: #fff;
  --accent: #8b6cff;
}

*{ box-sizing: border-box; }
html,body{ height: 100%; }
body{
  margin:0;
  background: var(--bg);
  color: var(--text);
  font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
}

/* ---- Topbar ---- */
.topbar{
  position: sticky; top: 0;
  z-index: 40;
  background: var(--bg);
  border-bottom: 1px solid var(--border);
  padding: 10px 12px env(safe-area-inset-top, 0);
  display:flex; align-items:center; justify-content:space-between;
}
.brand{ font-weight:700; }
.top-actions{ display:flex; gap:10px; align-items:center; }
.icon-btn{
  height:36px; min-width:36px; padding:0 8px;
  border-radius:10px; border:1px solid var(--border);
  background: rgba(255,255,255,.06); color:var(--text);
}
.tokens{ color:#cdb4ff; font-weight:700; }

/* menu */
.menu{
  position:absolute; right:12px; top:56px;
  background: var(--panel); border:1px solid var(--border);
  border-radius:12px; overflow:hidden;
}
.menu.hidden{ display:none; }
.menu ul{ list-style:none; margin:0; padding:6px; }
.menu li{ padding:10px 12px; border-radius:8px; }
.menu li:hover{ background:rgba(255,255,255,.06); }

/* ---- App ---- */
.app{
  min-height: calc(100dvh - 110px); /* topbar + footer approximatifs */
  padding-bottom: 120px; /* espace pour la barre d'entrée */
}
.chat-box{
  padding: 12px;
  display:flex; flex-direction:column; gap:10px;
}
.msg{ max-width:85%; padding:10px 12px; border-radius:12px; }
.msg.user{ margin-left:auto; background:#6e47ff; }
.msg.ai{ background: #20202a; }

/* ---- Barre d'entrée ---- */
.input-wrap{
  position: fixed; left:0; right:0;
  bottom: env(safe-area-inset-bottom, 0);
  padding: 10px 12px calc(10px + env(safe-area-inset-bottom, 0));
  background: linear-gradient(180deg, rgba(11,11,15,0) 0%, var(--bg) 20%, var(--bg) 100%);
  display:flex; align-items:flex-end; gap:10px;
  z-index: 50;
}

.circle{
  width: 44px; height: 44px; border-radius:14px;
  border:1px solid var(--border); background:rgba(255,255,255,.06);
  color:var(--text); font-size:22px;
}

.input-bar{ flex:1; display:flex; gap:8px; align-items:center; }
#userInput{
  flex:1; height:44px; padding:0 12px; border-radius:12px;
  border:1px solid var(--border); background:rgba(255,255,255,.06);
  color:var(--text); outline:none;
}
.send{
  height:44px; min-width:48px; border-radius:12px;
  border:1px solid var(--border);
  background: color-mix(in oklab, var(--accent) 35%, #ffffff 0%);
  color:#fff;
}

/* ---- Tiroir vertical (vers le haut) ---- */
.attach-tray{
  position:absolute;
  left:12px; /* aligné sous le + */
  bottom: 64px; /* au-dessus de la barre */
  display:flex; flex-direction:column; gap:10px;
  padding:10px;
  background: var(--panel);
  border:1px solid var(--border);
  border-radius:14px;
  opacity:0; transform: translateY(10px) scale(.98);
  pointer-events:none;
  transition: opacity .18s ease, transform .18s ease;
}
.attach-tray.open{
  opacity:1; transform: translateY(0) scale(1);
  pointer-events:auto;
}
.tray-btn{
  width:44px; height:44px; border-radius:12px;
  border:1px solid var(--border); background:rgba(255,255,255,.06);
  font-size:20px; color:var(--text);
}

/* ---- Footer ---- */
.powered{
  position: sticky; bottom:0;
  background: var(--bg); color: var(--muted);
  text-align:center; padding:10px;
  border-top:1px solid var(--border);
}

/* ---- Modal FAQ ---- */
.modal{ position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.5); z-index:60; }
.modal.hidden{ display:none; }
.modal-content{
  width:min(720px, 92vw);
  background:var(--panel); border:1px solid var(--border);
  color:var(--text); border-radius:16px; padding:18px 16px;
  max-height: 80dvh; overflow:auto;
}
.modal-close{ float:right; border:1px solid var(--border); background:transparent; color:var(--text); border-radius:10px; }
.modal h2{ margin-top:0; color:#bfa6ff; }
.modal h3{ margin-bottom:6px; }
.modal p, .modal li{ color:var(--muted); }

/* Prévenir zoom iOS sur input */
input, button { font-size:16px; }
