/* Variables & base */
*{box-sizing:border-box}
:root{
  --violet:#6a00ff;
  --violet-soft:#b085ff;
  --bg-dark:#0b0b0b;
  --panel:#141414;
  --text:#f5f5f5;
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --kb: 0px; /* hauteur clavier mobile injectée en JS */
}
html,body{height:100%;margin:0}
body{font-family:-apple-system,system-ui,Segoe UI,Inter,Roboto,sans-serif;color:var(--text);background:var(--bg-dark);}

/* Empêche zoom iOS au focus + lisibilité mobile */
input,textarea,select,button{
  font-size:16px;
  -webkit-text-size-adjust:100%;
}

/* Topbar */
.topbar{
  position:sticky; top:0; z-index:10;
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 14px; background:#111; border-bottom:1px solid #222;
}
.brand{font-weight:700}
.actions{display:flex;gap:10px;align-items:center}
.actions button{
  border:1px solid #333; background:#1b1b1b; color:#fff;
  border-radius:8px; padding:8px 10px; cursor:pointer
}
.tokens{color:var(--violet-soft);font-weight:700}

/* Menu */
.menu{
  position:fixed; right:12px; top:56px; z-index:12;
  background:#1b1b1b; border:1px solid #2a2a2a; border-radius:10px;
  box-shadow:0 10px 30px rgba(0,0,0,.6)
}
.menu.hidden{display:none}
.menu ul{list-style:none;margin:6px;padding:6px}
.menu li{padding:10px 12px;border-radius:8px;color:#fff;cursor:pointer}
.menu li:hover{background:var(--violet);}

/* Chat layout (mobile-first, stable avec clavier) */
.chat{
  height: calc(100dvh - 56px - 38px); /* écran total - header - footer */
  display:flex; flex-direction:column;
}
.chat-box{
  flex:1; overflow:auto; display:flex; flex-direction:column; gap:10px;
  padding:12px 12px 8px 12px;
  -webkit-overflow-scrolling:touch;
  overscroll-behavior:contain;
}
.msg{
  max-width:85%; padding:12px 14px; border-radius:12px; line-height:1.4;
  word-wrap:break-word; white-space:pre-wrap;
}
.msg.user{align-self:flex-end;background:var(--violet);color:#fff}
.msg.bot{align-self:flex-start;background:#1f1f1f;border:1px solid rgba(255,255,255,.08);color:#fff}
.typing{align-self:flex-start;background:rgba(20,0,60,.5);border:1px solid rgba(140,80,255,.6)}

/* Barre d’entrée fixe, avec prise en compte du safe-area + clavier */
.input-bar{
  position:sticky; bottom:0; z-index:9;
  display:flex; gap:8px; align-items:center;
  background:#111; border-top:1px solid #222;
  padding:10px 10px calc(10px + var(--safe-bottom) + var(--kb)) 10px;
}
#userInput{
  flex:1; border:1px solid #333; border-radius:10px;
  background:#161616; color:#fff; padding:12px 14px; outline:none
}
.ibtns{display:flex;gap:8px}
.ibtns button{
  border:1px solid #333; background:#1b1b1b; color:#fff;
  border-radius:10px; padding:10px 12px; cursor:pointer
}

/* FAQ modal (overlay) */
.faq-modal{
  position:fixed; inset:0; display:none;
  align-items:center; justify-content:center;
  background:rgba(0,0,0,.6); z-index:999;
  overscroll-behavior:contain;
}
.faq-modal.open{display:flex}
.faq-dialog{
  position:relative; width:min(680px,92vw); max-height:80vh; overflow:auto;
  background:#0f0a18; border:2px solid var(--violet); border-radius:16px;
  color:#fff; padding:20px 22px; box-shadow:0 20px 60px rgba(0,0,0,.7)
}
.faq-close{
  position:absolute; right:12px; top:8px; background:transparent; border:0;
  color:#fff; font-size:26px; cursor:pointer
}
.packs{margin:6px 0 12px 18px}

/* Footer */
.footer{
  height:38px; display:flex; align-items:center; justify-content:center;
  text-align:center; padding:0 8px; color:var(--violet-soft);
  background:#111; border-top:1px solid #222
}

/* Corps verrouillé quand modal/menu ouverts */
body.modal-open{
  position:fixed; width:100%;
  overflow:hidden;
}
