<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PhilomÃ¨ne I.A.</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- âœ… Clerk (Connexion) : version correcte pour ton domaine -->
  <script
    async
    crossorigin="anonymous"
    data-clerk-publishable-key="pk_live_Y2xlcmsucGhpbG9tZW5laWEuY29tJA"
    src="https://clerk.philomeneia.com/npm/@clerk/clerk-js@latest/dist/clerk.browser.js">
  </script>
</head>

<body class="theme-dark">
  <!-- Topbar -->
  <header id="topbar" role="banner">
    <div class="topbar__left">
      <button id="btnLogin" class="chip" aria-label="Se connecter">Connexion</button>
      <button id="btnBuy" class="chip" aria-label="Acheter des tokens">Acheter</button>
    </div>

    <div class="topbar__right">
      <div id="tokenBadge" class="gem" aria-live="polite">
        <span class="gem__icon" aria-hidden="true">ğŸ’</span>
        <span id="tokenCount">2 945</span>
      </div>
      <button id="btnMenu" class="chip icon" aria-haspopup="true" aria-expanded="false">â‰¡</button>
    </div>

    <nav id="menuDropdown" class="dropdown" hidden>
      <button id="toggleTheme" class="dropdown__item">ğŸŒ— Mode jour / nuit</button>
      <button id="openFaq" class="dropdown__item">â“ F.A.Q.</button>
    </nav>
  </header>

  <div id="versionLine" aria-live="polite">
    <span class="dot dot--on" aria-hidden="true"></span>
    <span>PhilomÃ¨ne I.A. â€” <strong id="appVersion">version 1.3</strong></span>
  </div>

  <main id="chat" role="main">
    <!-- ğŸŸ£ Message dâ€™accueil mis Ã  jour -->
    <div class="bubble bot">
      <div class="bubble__content">
        <p style="margin:0 0 8px 0;">Je suis <strong>PhilomÃ¨ne, ton assistant personnel</strong>. Voici ce que nous pouvons faire <strong>ensemble</strong> :</p>
        <ul style="margin:0;padding-left:18px;line-height:1.45">
          <li>ğŸ—£ï¸ RÃ©pondre Ã  tes questions, rÃ©diger, corriger, rÃ©sumer.</li>
          <li>ğŸ“° <strong>Actu importante en direct</strong> (Ã  venir trÃ¨s vite).</li>
          <li>ğŸ“· Analyser des images et te donner des explications.</li>
          <li>ğŸ·ï¸ <strong>Scanner un code-barres</strong> (bÃªta) pour retrouver Nutri-Score et infos produit.</li>
          <li>ğŸ’° Packs de tokens simples, pas dâ€™abonnement.</li>
          <li>ğŸ”’ Tes Ã©changes restent privÃ©s entre toi et moi.</li>
        </ul>
        <p style="margin:10px 0 0 0;color:var(--text-dim)">Tu peux commencer Ã  Ã©crire en bas, ou mâ€™envoyer une image.</p>
      </div>
    </div>

    <div id="messages" aria-live="polite"></div>
  </main>

  <footer id="composer">
    <button id="plusBtn" class="fab" aria-label="Joindre">+</button>

    <div class="inputWrap">
      <input id="userInput" type="text" placeholder="Ã‰crivez votre messageâ€¦" autocomplete="off" />
      <button id="micBtn" class="iconBtn" aria-label="Parler">ğŸ¤</button>
    </div>

    <button id="sendBtn" class="sendBtn" aria-label="Envoyer">â¤</button>

    <div id="attachSheet" class="sheet" hidden>
      <div class="sheet__title">Joindreâ€¦</div>
      <div class="sheet__row">
        <button id="pickLibrary" class="pill">ğŸ“· PhotothÃ¨que</button>
        <button id="takePhoto" class="pill">ğŸ“¸ Prendre une photo</button>
        <button id="pickFile" class="pill">ğŸ—‚ï¸ Choisir un fichier</button>
        <button id="closeSheet" class="pill pill--ghost">Fermer</button>
      </div>
      <input id="imgLibraryInput" type="file" accept="image/*" hidden />
      <input id="imgCameraInput" type="file" accept="image/*" capture="environment" hidden />
      <input id="docInput" type="file" hidden />
    </div>
  </footer>

  <dialog id="modal" class="modal" aria-modal="true">
    <div class="modal__card">
      <div id="modalTitle" class="modal__title">Titre</div>
      <div id="modalBody" class="modal__body">Contenuâ€¦</div>
      <div class="modal__actions">
        <button id="modalClose" class="pill pill--ghost">Fermer</button>
      </div>
    </div>
  </dialog>

  <dialog id="faqModal" class="modal" data-kind="faq" aria-modal="true">
    <div class="modal__card">
      <div class="modal__title">ğŸ’¬ Foire aux questions</div>
      <div class="modal__body">
        <p><strong>Quelle IA utilise PhilomÃ¨ne ?</strong><br>PhilomÃ¨ne I.A. fonctionne avec un modÃ¨le avancÃ© de conversation.</p>
        <p><strong>Comment fonctionnent les tokens ?</strong><br>Chaque Ã©change consomme des tokens selon la longueur du message.</p>
        <p><strong>Packs disponibles</strong><br>
          ğŸ’ <strong>1 000 000</strong> tokens â†’ <strong>5 â‚¬</strong><br>
          ğŸ’ <strong>2 000 000</strong> tokens â†’ <strong>10 â‚¬</strong><br>
          ğŸ’ <strong>4 000 000</strong> tokens â†’ <strong>20 â‚¬</strong><br>
          ğŸ <strong>Premier achat : +50 % offerts</strong>
        </p>
        <p><strong>Abonnement ?</strong><br>Non, vous payez uniquement ce que vous consommez.</p>
      </div>
      <div class="modal__actions">
        <button id="faqClose" class="pill pill--ghost">Fermer</button>
      </div>
    </div>
  </dialog>

  <dialog id="payModal" class="modal" aria-modal="true">
    <div class="modal__card">
      <div class="modal__title">Acheter des tokens</div>
      <div class="modal__body">
        <div class="packsRow" style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px">
          <button class="pill" data-pack="5">5â‚¬ â€¢ 1M</button>
          <button class="pill" data-pack="10">10â‚¬ â€¢ 2M</button>
          <button class="pill" data-pack="20">20â‚¬ â€¢ 4M</button>
        </div>
        <div id="paypal-buttons" style="margin:8px 0 4px 0"></div>
        <div style="margin-top:6px;color:var(--text-dim);font-size:14px">
          ğŸ Premier achat : <strong>+50%</strong> de tokens offerts.
        </div>
      </div>
      <div class="modal__actions">
        <button id="payClose" class="pill pill--ghost">Fermer</button>
      </div>
    </div>
  </dialog>

  <!-- âŒ EnlevÃ© : mention â€œPropulsÃ© par GPT-5â€ -->
  <!-- <div id="techFooter">â€¦</div> -->

  <script src="scripts.js" defer></script>

  <!-- âœ… Script pour ouvrir la fenÃªtre Clerk -->
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      await window.Clerk.load({
        publishableKey: "pk_live_Y2xlcmsucGhpbG9tZW5laWEuY29tJA",
      });
      document.getElementById("btnLogin").addEventListener("click", () => {
        window.Clerk.openSignIn();
      });
    });
  </script>
</body>
</html>
